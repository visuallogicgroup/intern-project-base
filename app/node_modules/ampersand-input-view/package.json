{
  "name": "ampersand-input-view",
  "description": "A view module for intelligently rendering and validating input. Works well with ampersand-form-view.",
  "version": "4.0.5",
  "author": {
    "name": "Henrik Joreteg",
    "email": "henrik@andyet.net"
  },
  "browserify": {
    "transform": [
      "ampersand-version"
    ]
  },
  "bugs": {
    "url": "https://github.com/ampersandjs/ampersand-input-view/issues"
  },
  "dependencies": {
    "ampersand-dom": "^1.2.7",
    "ampersand-version": "^1.0.1",
    "ampersand-view": "^7.2.1",
    "matches-selector": "^1.0.0"
  },
  "devDependencies": {
    "ampersand-view-conventions": "^1.1.5",
    "browserify": "^5.10.1",
    "function-bind": "^1.0.0",
    "jshint": "^2.5.6",
    "phantomjs": "^1.9.7-15",
    "precommit-hook": "^1.0.7",
    "run-browser": "^1.3.1",
    "tap-spec": "^0.2.1",
    "tape": "^2.14.0",
    "tape-run": "^0.3.0",
    "tape-suite": "^0.2.1"
  },
  "homepage": "https://github.com/ampersandjs/ampersand-input-view",
  "keywords": [
    "forms",
    "ampersand",
    "browser"
  ],
  "license": "MIT",
  "main": "ampersand-input-view.js",
  "repository": {
    "type": "git",
    "url": "git://github.com/ampersandjs/ampersand-input-view"
  },
  "scripts": {
    "start": "run-browser test/index.js",
    "test": "browserify test/index.js | tape-run | tap-spec"
  },
  "readme": "# ampersand-input-view\n\nLead Maintainer: [Christopher Dieringer (@cdaringe)](https://github.com/cdaringe)\n\n## Purpose\nA view module for intelligently rendering and validating input. Works well with [ampersand-form-view](https://github.com/AmpersandJS/ampersand-form-view).\n\nIt does the following:\n\n- Automatically shows/hides error messages based on tests\n- Will not show error messages pre-submit, or if it's never had a valid value. This lets people tab-through a form without triggering a bunch of error messages.\n- Live-validates, to always report if in valid state. But only shows messages when sane to do so.\n- Only shows first failed message. Then, as the user corrects, updates and validates against all tests, showing appropriate message, until all tests pass.\n\nIt's built on [ampersand-view](https://github.com/AmpersandJS/ampersand-view), so you can use it with `extend` as expected.\n\n\n## install\n\n```\nnpm install ampersand-input-view\n```\n\n## example\n\n```javascript\nvar FormView = require('ampersand-form-view');\nvar InputView = require('ampersand-input-view');\n\n\nmodule.exports = FormView.extend({\n    fields: function () {\n        return [\n            new InputView({\n                label: 'Address',\n                name: 'address',\n                value: this.model.address || '',\n                required: false,\n                placeholder: '2000 Avenue of the Stars, Los Angeles CA',\n                parent: this\n            })\n        ];\n    }\n});\n\n```\n\n## API Reference\n\n### extend `AmpersandInputView.extend({ })`\n\nSince this view is based on [ampersand-state](http://ampersandjs.com/docs#ampersand-state), it can be extended in the same way.\n\nTo create an **`InputView`** class of your own, you extend **`AmpersandInputView`** and provide instance properties and options for your class. Here, you will typically pass any properties (`props`, `session`, and `derived`) of your state class, and any methods to be attached to instances of your class.\n\n**Note:** If you want to add **`initialize()`**, remember that it’s overriding InputView’s own `initialize()`. Thus, you should call the parent's `initialize()` manually:\n\n\n```javascript\nvar AmpersandInputView = require('ampersand-input-view');\n\nvar MyCustomInput = AmpersandInputView.extend({\n    initialize: function () {\n        // call its parent's initialize manually\n        AmpersandInputView.prototype.initialize.apply(this, arguments);\n\n        // do whatever else you need to do on init here\n    }\n});\n```\n\n\n### constructor/initialize `new AmpersandInputView([opts])`\n\nWhen creating an instance of an `InputView`, you can pass in the initial values of the **attributes** which will be [`set`](http://ampersandjs.com/docs#ampersand-state-set) on the state. Unless [`extraProperties`](#amperand-state-extra-properties) is set to `allow`, you will need to have defined these attributes in `props` or `session`.\n\n\n#### opts\n\n- `tests` (default: `[]`): test function to run on input (more below).\n- `name`: the input's `name` attribute's value. Used when reporting to parent form.\n- `type` (default: `'text'`): input type to use, can be any valid HTML5 input type.\n- `value`: initial value for the `<input>`.\n- `template`: a custom template to use (see 'template' section, below, for more).\n- `placeholder`: (optional) “placeholder text” for the input.\n- `el`: (optional) element if you want to render it into a specific exisiting element pass it on initialization.\n- `required` (default: `true`): whether this field is required or not.\n- `requiredMessage` (default: `'This field is required'`): message to use if required and empty.\n- `validClass` (default: `'input-valid'`): class to apply to input if valid (see below for customizing where this is applied).\n- `invalidClass` (default: `'input-invalid'`): class to apply to input if invalid (see below for customizing where this is applied).\n- `parent`: a View instance to use as the `parent` for this input. If your InputView is in a FormView, this is automatically set for you.\n- `beforeSubmit`: function called by [ampersand-form-view](https://github.com/AmpersandJS/ampersand-form-view) during submit. By default this runs the tests and displays error messages.\n\n\n### render `inputView.render()`\n\nRenders the inputView. This is called automatically if your inputView is used within a parent [ampersand-form-view](https://github.com/ampersandjs/ampersand-form-view).\n\n### template `inputView.template`\n\nThis can either be customized by using `extend`, or by passing in a `template` on instantiation.\n\nIt can be a function that returns a string of HTML or DOM element—or just an plain old HTML string.\n\nBut whatever it is, the resulting HTML should contain the following hooks:\n\n- an `<input>` or `<textarea>` element\n- an element with a `data-hook=\"label\"` attribute\n- an element with a `data-hook=\"message-container\"` attribute (this we'll show/hide)\n- an element with a `data-hook=\"message-text\"` attribute (where message text goes for error)\n\nCreating a new class:\n\n```javascript\n// creating a custom input that has an alternate template\nvar CustomInput = AmpersandInputView.extend({\n    template: [\n        '<label>',\n            '<input class=\"form-input\">',\n            '<span data-hook=\"label\"></span>',\n            '<div data-hook=\"message-container\" class=\"message message-below message-error\">',\n                '<p data-hook=\"message-text\"></p>',\n            '</div>',\n        '</label>'\n    ].join('');\n});\n\n// Then any instances of that would have it\nvar myCustomInput = new CustomInput();\n```\n\nSetting the template when instantiating it:\n\n```\n// Or you can also pass it in when creating the instance\nvar myInput = new AmpersandInputView({\n    template: myCustomTemplateStringOrFunction\n});\n```\n\n### value `new AmpersandInputView({ value: 'something' })`\n\nIf you pass `value` on instantiation, it will be set on the `<input>` element (and also tracked as `startingValue`).\n\nThis is also the value that will be reverted to if we call `.reset()` on the input.\n\n```javascript\nvar myInput = new AmpersandInputView({\n    name: 'company name',\n    value: '&yet'\n});\nmyInput.render();\nconsole.log(myInput.input.value); //=> '&yet'\n\nmyInput.setValue('something else');\nconsole.log(myInput.input.value); //=> 'something else'\nmyInput.setValue('something else');\nmyInput.reset();\nconsole.log(myInput.input.value); //=> '&yet'\n```\n\n### Customizing the view\n\n#### Custom calculated output `value`\n\nIf you need to decouple what the user puts into the form from the resulting value, you can do that by overriding the `value` derived property.\n\nFor example, consider a validated address input. You may have a single text input for address, which you can attempt to match to a real known address with an API call. So, you have a single `<input>`, but you want the inputView’s `value` to be an object returned from that API.\n\nDo it by overriding the `value` derived property as follows:\n\n```javascript\nvar VerifiedAddressInput = AmpersandInputView.extend({\n    initialize: function () {\n        // call parent constructor\n        AmpersandInputView.prototype.initialize.apply(this, arguments);\n\n        // listen for changes to input value\n        this.on('change:inputValue', this.validateAddress, this);\n    },\n    props: {\n        verifiedAddress: {\n            type: 'object'\n        }\n    },\n    derived: {\n        value: {\n            // in you want it re-calculated\n            // when the user changes input\n            // make it dependent on `inputValue`\n            deps: ['verifiedAddress'],\n            fn: function () {\n                // calculate your value here\n                return this.verifiedAddress;\n            }\n        },\n        // you may also want to change what\n        // deterines if this field should be\n        // considerd valid. In this case, whether\n        // it has a validated address\n        valid: {\n            deps: ['value'],\n            fn: function () {\n                if (this.verifiedAddress) {\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n        }\n    },\n    // run our address verification\n    validateAddress: function () {\n        // validate it against your API (up to you how)\n        validateIt(this.inputValue, function (result) {\n            this.verifiedAddress = result;\n        });\n    }\n});\n```\n\n#### Setting valid/invalid classes\nBy default, `validClass` and `invalidClass` are set on either the `input` or `textarea` in the rendered template.  This is done via a `validityClassSelector` property that is used to find the elements to apply either `validClass` or `invalidClass`. You can set `validityClassSelector` to have this class applied anywhere you need in your rendered template\n\nFor instance, this would set the class on the root label instead:\n\n```javascript:\nvar CustomInput = InputView.extend({\n    validityClassSelector: 'label'\n});\n```\n\nAnd this would set it on the root label and the message element\n```javascript:\nvar CustomInput = InputView.extend({\n    validityClassSelector: 'label, [data-hook=message-text]'\n});\n```\n\n### tests `InputView.extend({ tests: [test functions] });` or `new InputView({ tests: [] })`\n\nYou can provide tests inside `extend`, or passed them in for `initialize`.\n\nThis should be an array of test functions. The test functions will be called with the context of the inputView, and receive the input `value` as the argument.\n\nThe tests should return an error message if invalid, and return a falsy value otherwise (or, simply not return at all).\n\n```javascript\nvar myInput = new InputView({\n    name: 'tweet',\n    label: 'Your Tweet',\n    tests: [\n        function (value) {\n            if (value.length > 140) {\n                return \"A tweet can be no more than 140 characters\";\n            }\n        }\n    ]\n});\n```\n\n**Note:** You can still do `required: true` and pass tests. If you do, it will check if it's not empty first, and show the `requiredMessage` error if it is.\n\nRemember that the inputView will only show one error per field at a time. This is to minimize annoyance. We don't want to show “this field is required” and every other error if they just left it empty. We just show the first one that fails, then when they go to correct it, it will update to reflect the next failed test (if any).\n\n\n### setValue `inputView.setValue([value], [skipValidation|bool])`\n\nSetter for value that will fire all appropriate handlers/tests. Can also be done by user input or setting value of `input` manually.\n\nPassing `true` as second argument will skip validation. This is mainly for internal use.\n\n#### Setting input.value on non-user input\nThis module assumes that the value of the input element will be set by the user.  This is the only event that can be reliably listened for on an input element.  If you have a third-party library (i.e. Bootstrap or jQuery) that is going to be affecting the input value directly you will need to let your model know about the change via `setValue`.\n\n```javascript\nvar myInput = new InputView({\n    name: 'date'\n});\nmyInput.render();\ndocument.body.appendChild(myInput.el);\n\n$('[name=address]').datepicker({\n    onSelect: function (newDate) {\n        myInput.setValue(newDate);\n    }\n});\n\n```\n\n### reset `inputView.reset()`\n\nSet value to back original value. If you passed a `value` when creating the view it will reset to that, otherwise to `''`.\n\n\n### clear `inputView.clear()`\n\nSets value to `''` no matter what previous values were.\n\n## gotchas\n- Some browsers do not always fire a `change` event as expected.  In these [rare cases](https://github.com/AmpersandJS/ampersand-input-view/issues/2), validation may not occur when expected.  Validation *will occur* regardless on form submission, specifically when this field's `beforeSubmit` executes.\n\n## changelog\n- 4.0.5\n - Handle uncaught input value changes beforeSubmit\n - Add view convention tests, and update to pass them\n- 4.0.0\n - Remove `rootElementClass` in favor of a better validityClass selector\n - Listen to `change` instead of `blur` event\n - Reset error message state on `clear()` and `reset()`\n - Allow `beforeSubmit` to be defined on initialization\n- 3.1.0 - Add [ampersand-version](https://github.com/ampersandjs/ampersand-version) for version tracking.\n- 3.0.0 - Add API reference docs. Add `.clear()`, `.reset()` methods. Make `value` derived property. Fix #21 validity class issue.\n- 2.1.0 - Can now set `rootElementClass`. Add reset function #15. Allow setting `0` as value #17.\n- 2.0.2 - Make sure templates can be passed in, in constructor.\n\n## credits\n\nCreated by [@HenrikJoreteg](http://twitter.com/henrikjoreteg).\n\n## license\n\nMIT\n\n",
  "readmeFilename": "README.md",
  "_id": "ampersand-input-view@4.0.5",
  "_from": "ampersand-input-view@^4.0.5"
}
